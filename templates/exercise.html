<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8"/>
        <meta name="Description" content="Gym Log"/>
        <meta name="viewport" content="width=device-width"/>
        <title>{{ name }} | Gym Log</title>
        <link rel="stylesheet" type="text/css" href="/static/css/exercise.css"/>
        <link rel="stylesheet" type="text/css" href="/static/css/graph.css"/>
        <script type="module" src="/static/js/exercise.js"></script>
        <!-- icons and manifest for PWA -->
        <link rel="manifest" href="/static/manifest.json"/>
        <link rel="icon" href="/static/favicon.svg" type="image/svg+xml"/>
        <meta name="theme-color" content="#32302f"/>
    </head>
    <body>

        <section id="header">
            <a id="home-shortcut" href="/">
                <svg width="550" height="550" viewBox="0 0 412.5 412.5" xmlns="http://www.w3.org/2000/svg">
                    <g fill="#32302f">
                        <path d="M381.278 57.001L369.97 44.646 357.99 55.61l11.307 12.355zM369.433 115.68c5.077 5.584 14.21 6.09 19.793 1.017 5.582-5.077 6.089-14.21 1.016-19.793l-20.809-22.836-16.747-18.27-20.809-22.837c-2.538-2.538-6.089-4.567-9.643-4.567-3.555 0-7.105 1.016-10.15 3.555-5.582 5.076-6.088 14.21-1.015 19.792l20.808 22.837 16.242 17.757zM342.78 92.408l-11.307-12.355-4.117 3.77 11.307 12.356zM351.163 167.446c6.599 7.105 17.765 7.611 24.869 1.016 7.104-6.599 7.61-17.764 1.016-24.868l-38.57-42.123-16.747-18.27-38.57-42.123c-3.044-3.554-7.61-5.582-12.18-5.582-4.567 0-9.133 1.522-12.688 4.566-7.105 6.599-7.61 17.765-1.016 24.869l38.57 42.122 16.747 18.27zM307.02 124.78l-11.308-12.355-4.117 3.77 11.308 12.355zM326.296 228.854c8.627 9.643 23.347 10.149 32.48 1.522 9.643-8.627 10.149-23.347 1.522-32.48l-57.855-63.438-16.748-18.27L227.84 52.75c-4.06-4.566-9.643-7.104-16.242-7.61-6.089-.507-12.18 2.028-16.747 6.088-9.644 8.627-10.15 23.347-1.522 32.48l58.364 63.438 16.748 18.27zM263.12 165.434l-11.306-12.355-102.58 93.888 11.308 12.355zM184.195 359.281c8.627 9.644 23.347 10.15 32.48 1.523 9.644-8.627 10.15-23.347 1.523-32.48l-57.855-63.438-16.748-18.27-57.855-63.438c-8.627-9.643-23.347-10.149-32.48-1.522-4.567 4.06-7.105 9.643-7.611 16.242-.506 6.089 2.028 12.18 6.089 16.747l57.855 62.929 16.747 18.27zM120.413 295.844l-11.307-12.355-4.117 3.77 11.307 12.355zM128.878 370.954c6.598 7.105 17.764 7.611 24.868 1.016 7.105-6.599 7.611-17.764 1.016-24.869l-38.569-42.122-16.748-18.27-38.569-42.123c-6.598-7.105-17.764-7.61-24.868-1.016-3.554 3.045-5.583 7.611-5.583 12.181 0 4.567 1.522 9.133 4.567 12.688L73.56 310.56l16.748 18.27zM84.653 328.206l-11.308-12.355-4.117 3.77 11.308 12.355zM80.665 379.581c5.077 5.583 14.21 6.09 19.793 1.016 5.582-5.076 6.089-14.21 1.016-19.792l-20.809-22.837-16.747-18.27-20.809-22.836c-5.076-5.583-14.21-6.09-19.792-1.016-2.539 2.538-4.567 6.089-4.567 9.643 0 3.555 1.016 7.611 3.554 10.15l20.809 22.836 16.747 18.27zM54.13 356.753l-11.307-12.355-12.73 11.65L41.4 368.403z"/>
                    </g>
                </svg>
            </a>
            <h1>{{ name }}</h1>
            <div id="graph-button">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16">
                  <path fill-rule="evenodd" d="M0 0h1v15h15v1H0V0Zm10 3.5a.5.5 0 0 1 .5-.5h4a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-1 0V4.9l-3.613 4.417a.5.5 0 0 1-.74.037L7.06 6.767l-3.656 5.027a.5.5 0 0 1-.808-.588l4-5.5a.5.5 0 0 1 .758-.06l2.609 2.61L13.445 4H10.5a.5.5 0 0 1-.5-.5Z"/>
                </svg>
            </div>
        </section>

        <section id="historical-sets">
            {%- for group in sets -%}
            <div class="set-group">
                {%- for s in group -%}
                <div class="set-card" data-uid="{{ s.uid }}" data-type="{{ type }}" data-distance="{{ s.distance if s.distance is not none }}" data-repetitions="{{ s.repetitions if s.repetitions is not none }}" data-weight="{{ s.weight if s.weight if not none }}" data-hours="{{ s.hours if s.hours if not none }}" data-mins="{{ s.mins if s.mins is not none }}" data-seconds="{{ s.seconds if s.seconds is not none }}">
                    <div class="set-top-row">
                        <h3>{{ s.set_detail }}</h3>
                        {% if s.delta is not none %}
                            {%- if s.delta > 0 %}
                            <span class="increase">{{ "+%.1f"|format(s.delta) }}%</span>
                            {%- else -%}
                            <span class="decrease">{{ "%.1f"|format(s.delta) }}%</span>
                            {%- endif -%}
                        {% else %}
                        <span class="equal">=</span>
                        {% endif %}
                    </div>
                    <small>{{ s.readable_time }}</small>
                </div>
                {%- endfor -%}
            </div>
            {%- endfor -%}
        </section>

        <section id="new-set">
            <form action="/set/" method="POST">
                <input type="hidden" name="exerciseID" id="exerciseID" value="{{ exerciseID }}"/>
                {%- if type == "weight-repetitions" -%}
                <div class="new-input">
                    <input type="text" inputmode="numeric" pattern="[0-9]+" id="reps" name="reps" autocomplete="off" value="{{ sets[0][0].repetitions if sets and sets[0][0].repetitions is not none }}"/>
                    Reps
                </div>
                <div class="new-input">
                    <input type="text" inputmode="numeric" pattern="[0-9]+([\.][0-9]+)?" id="weight" name="weight" autocomplete="off" value="{{ sets[0][0].weight if sets and sets[0][0].weight is not none }}"/>
                    kg
                </div>
                {%- elif type == "distance-time" -%}
                <div class="new-input">
                    <input type="text" inputmode="numeric" pattern="[0-9]+([\.][0-9]+)?" id="distance" name="distance" autocomplete="off" value="{{ sets[0][0].distance if sets and sets[0][0].distance is not none }}"/>
                    m
                </div>
                <div class="new-input">
                    <input class="time-input" type="text" inputmode="numeric" pattern="[0-9]+" id="hours" name="hours" autocomplete="off" value="{{ sets[0][0].hours if sets and sets[0][0].hours is not none }}" placeholder="hh"/>&nbsp;:
                    <input class="time-input" type="text" inputmode="numeric" pattern="[0-9]+" id="mins" name="mins" autocomplete="off" value="{{ sets[0][0].mins if sets and sets[0][0].mins is not none }}" placeholder="mm"/>&nbsp;:
                    <input class="time-input" type="text" inputmode="numeric" pattern="[0-9]+" id="secs" name="secs" autocomplete="off" value="{{ sets[0][0].seconds if sets and sets[0][0].seconds is not none }}" placeholder="ss"/>
                </div>
                {%- elif type == "time" -%}
                <div class="new-input">
                    <input class="time-input" type="text" inputmode="numeric" pattern="[0-9]+" id="hours" name="hours" autocomplete="off" value="{{ sets[0][0].hours if sets and sets[0][0].hours is not none }}" placeholder="hh"/>&nbsp;:
                    <input class="time-input" type="text" inputmode="numeric" pattern="[0-9]+" id="mins" name="mins" autocomplete="off" value="{{ sets[0][0].mins if sets and sets[0][0].mins is not none }}" placeholder="mm"/>&nbsp;:
                    <input class="time-input" type="text" inputmode="numeric" pattern="[0-9]+" id="secs" name="secs" autocomplete="off" value="{{ sets[0][0].seconds if sets and sets[0][0].seconds is not none }}" placeholder="ss"/>
                </div>
                <div class="timer">
                    <button type="button" class="fab timer-btn" id="timer-start-btn">
                        <img src="/static/img/play.svg" alt="Start timer" height="1" width="1"/>
                    </button>
                    <div>
                        <span id="timer-display">&ndash;&ndash;:&ndash;&ndash;:&ndash;&ndash;</span>
                        <span id="timer-display-millis" class="millis">&ndash;&ndash;&ndash;</span>
                    </div>
                    <button type="button" class="fab timer-btn" id="timer-stop-btn">
                        <img src="/static/img/stop.svg" alt="Stop timer" height="1" width="1"/>
                    </button>
                </div>
                {%- endif -%}
                <button type="submit" class="fab" id="fab">
                    +
                </button>
            </form>
        </section>

        <section id="graph" class="hidden animate">
            <h4>Historical progress</h4>
            <div class="graph-wrapper">
                <div class="graph-chart">
                    {%- for age, values in graph.items() -%}
                    <div class="graph-group">
                        {%- for v in values -%}
                        <div class="graph-bar" style="--size:{{ v.scaled }};" data-value="{{ v.value }}"></div>
                        {%- endfor -%}
                    </div>
                    {%- endfor -%}
                    <div class="graph-group">
                        <div class="graph-bar" style="--size: 1; background-color: transparent;"></div>
                    </div>
                </div>
            </div>
            <p>Most recent ‚ü∂</p>
            <svg xmlns="http://www.w3.org/2000/svg" class="swipe-arrow" preserveAspectRatio="none" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                <path stroke-linejoin="round" d="M4.5 15.75l7.5-7.5 7.5 7.5" />
            </svg>

        </section>
    </body>

    <dialog id="edit-set-dialog">
        <form method="dialog">
            <h2>Edit set</h2>
            <input type="hidden" name="setID" id="setID" value=""/>
            {%- if type == "weight-repetitions" -%}
            <div class="edit-set-input">
                <label for="repetitions">Reps</label>
                <input type="text" inputmode="numeric" id="repetitions" name="repetitions" autocomplete="off" value=""/>
            </div>
            <div class="edit-set-input">
                <label for="weight_kg">Weight (kg)</label>
                <input type="text" inputmode="numeric" id="weight_kg" name="weight_kg" autocomplete="off" value=""/>
            </div>
            {%- elif type == "distance-time" -%}
            <div class="edit-set-input">
                <label for="distance_m">Distance (m)</label>
                <input type="text" inputmode="numeric" id="distance_m" name="distance_m" autocomplete="off" value=""/>
            </div>
            <div class="edit-set-input">
                <label for="hours">Time</label>
                <input class="time-input" type="text" inputmode="numeric" id="hours" name="hours" autocomplete="off" value="" placeholder="hh"/>&nbsp;:
                <input class="time-input" type="text" inputmode="numeric" id="mins" name="mins" autocomplete="off" value="" placeholder="mm"/>&nbsp;:
                <input class="time-input" type="text" inputmode="numeric" id="seconds" name="seconds" autocomplete="off" value="" placeholder="ss"/>
            </div>
            {%- elif type == "time" -%}
            <div class="edit-set-input">
                <label for="hours">Time</label>
                <input class="time-input" type="text" inputmode="numeric" id="hours" name="hours" autocomplete="off" value="" placeholder="hh"/>&nbsp;:
                <input class="time-input" type="text" inputmode="numeric" id="mins" name="mins" autocomplete="off" value="" placeholder="mm"/>&nbsp;:
                <input class="time-input" type="text" inputmode="numeric" id="seconds" name="seconds" autocomplete="off" value="" placeholder="ss"/>
            </div>
            {%- endif -%}
            <div class="buttons">
                <button type="submit" value="edit">Edit</button>
                <button type="submit" value="delete">Delete</button>
                <button type="submit" value="cancel">Cancel</button>
            </div>
        </form>
    </dialog>
</html>